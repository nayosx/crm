<div class="flex align-items-center gap-2 mb-3 border-bottom-1 surface-border pb-2 mb-2">
  <h2>Lista de Usuarios</h2>
</div>

<div class="mt-3 mb-3 flex gap-2 flex-row">
  <button pButton label="Create Usuario" icon="pi pi-plus" (click)="openCreateUser()"></button>
  <button pButton label="Create Rol" icon="pi pi-plus" severity="secondary" (click)="openCreateRole()"></button>
</div>

<p-table
  [value]="(users$ | async) || []"
  [loading]="loading$ | async"
  dataKey="id"
>
  <ng-template pTemplate="header">
    <tr>
      <!-- <th>Username</th> -->
      <th>Name</th>
      <th>Phone</th>
      <th>Role</th>
      <th>Actions</th>
    </tr>
  </ng-template>
  <ng-template let-user pTemplate="body">
    <tr>
      <!-- <td>{{ user.username }}</td> -->
      <td>{{ user.name }}</td>
      <td>{{ user.phone }}</td>
      <td>{{ getRoleName(user.role_id) }}</td>
      <td>
        <div class="flex gap-2 flex-row">
            <button pButton icon="pi pi-pencil" (click)="openEditUser(user)"></button>
            <button pButton icon="pi pi-trash" severity="danger" (click)="deleteUser(user)"></button>
        </div>
      </td>
    </tr>
  </ng-template>
</p-table>

<p-dialog
  header="User Form"
  [(visible)]="displayUserDialog"
  [modal]="true"
  [closable]="true"
  [dismissableMask]="true"
>
  <app-user-form
    [initialData]="selectedUser"
    [roles]="roles$ | async"
    (submitForm)="saveUser($event)"
  />
</p-dialog>

<p-dialog
  header="Role Form"
  [(visible)]="displayRoleDialog"
  [modal]="true"
  [closable]="true"
  [dismissableMask]="true"
>
  <app-rol-form
    [initialData]="selectedRole"
    (submitForm)="saveRole($event)"
  />
</p-dialog>
